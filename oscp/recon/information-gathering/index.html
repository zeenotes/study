



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.2">
    
    
      
        <title>Information Gathering</title>
      
    
	
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../assets/css/extra.css">
    
      <link rel="stylesheet" href="../../../assets/css/mermaid.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="grey">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#open_source_intelligence_gathering_osint" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="ha2332" class="md-header-nav__button md-logo">
          
            <img src="../../../assets/images/logo-black-big.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              ha2332
            </span>
            <span class="md-header-nav__topic">
              Information Gathering
            </span>
          
        </div>
      </div>
	  <!-- custom code -->
	  <div class="md-flex__cell md-flex__cell--shrink">
        <button id="toggle-sidebar"><i class="material-icons">
			calendar_view_day
		</i></button>
      </div>
	  <!-- custom code -->
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../linux/linux-fundamentals/" title="Linux" class="md-tabs__link">
          Linux
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" title="Oscp" class="md-tabs__link md-tabs__link--active">
          Oscp
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../programming/bash-scripting/" title="Programming" class="md-tabs__link">
          Programming
        </a>
      
    </li>
  

      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="ha2332" class="md-nav__button md-logo">
      
        <img src="../../../assets/images/logo-black-big.png" width="48" height="48">
      
    </a>
    ha2332
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../../linux/linux-fundamentals/" title="Linux Fundamentals" class="md-nav__link">
      Linux Fundamentals
    </a>
  </li>

			
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../../linux/linux_cmd/" title="Linux Command Line" class="md-nav__link">
      Linux Command Line
    </a>
  </li>

			
        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../" title="OSCP Prep Guide" class="md-nav__link">
      OSCP Prep Guide
    </a>
  </li>

			
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../links/" title="OSCP Links" class="md-nav__link">
      OSCP Links
    </a>
  </li>

			
        
			
			  
			  
			  

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Information Gathering
      </label>
    
    <a href="./" title="Information Gathering" class="md-nav__link md-nav__link--active">
      Information Gathering
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#open_source_intelligence_gathering_osint" title="Open Source Intelligence Gathering (OSINT)" class="md-nav__link">
    Open Source Intelligence Gathering (OSINT)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#netcraft" title="Netcraft" class="md-nav__link">
    Netcraft
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whois_lookups" title="WhoIs Lookups" class="md-nav__link">
    WhoIs Lookups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns_reconnaissance" title="DNS Reconnaissance" class="md-nav__link">
    DNS Reconnaissance
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nslookup" title="Nslookup" class="md-nav__link">
    Nslookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" title="Host" class="md-nav__link">
    Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zone_transfers" title="Zone Transfers" class="md-nav__link">
    Zone Transfers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#searching_for_email_addresses" title="Searching For Email Addresses" class="md-nav__link">
    Searching For Email Addresses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maltego" title="Maltego" class="md-nav__link">
    Maltego
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port_scanning" title="Port Scanning" class="md-nav__link">
    Port Scanning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual_port_scanning" title="Manual Port Scanning" class="md-nav__link">
    Manual Port Scanning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated_port_scanning_-_nmap" title="Automated Port Scanning - NMap" class="md-nav__link">
    Automated Port Scanning - NMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_syn_scan" title="A SYN Scan" class="md-nav__link">
    A SYN Scan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a_version_scan" title="A Version Scan" class="md-nav__link">
    A Version Scan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#udp_scans" title="UDP Scans" class="md-nav__link">
    UDP Scans
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning_a_specific_port" title="Scanning A Specific Port" class="md-nav__link">
    Scanning A Specific Port
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

			
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../scanning/network_discovery/" title="Network discovery" class="md-nav__link">
      Network discovery
    </a>
  </li>

			
        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Programming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Programming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../../programming/bash-scripting/" title="Bash Scripting" class="md-nav__link">
      Bash Scripting
    </a>
  </li>

			
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../../programming/c-programming/" title="C Programming" class="md-nav__link">
      C Programming
    </a>
  </li>

			
        
			
			  
			  
			  


  <li class="md-nav__item">
    <a href="../../../programming/python-programming/" title="Python Programming" class="md-nav__link">
      Python Programming
    </a>
  </li>

			
        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../tools/metasploit/" title="Metasploit" class="md-nav__link">
      Metasploit
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#open_source_intelligence_gathering_osint" title="Open Source Intelligence Gathering (OSINT)" class="md-nav__link">
    Open Source Intelligence Gathering (OSINT)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#netcraft" title="Netcraft" class="md-nav__link">
    Netcraft
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whois_lookups" title="WhoIs Lookups" class="md-nav__link">
    WhoIs Lookups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns_reconnaissance" title="DNS Reconnaissance" class="md-nav__link">
    DNS Reconnaissance
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nslookup" title="Nslookup" class="md-nav__link">
    Nslookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" title="Host" class="md-nav__link">
    Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zone_transfers" title="Zone Transfers" class="md-nav__link">
    Zone Transfers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#searching_for_email_addresses" title="Searching For Email Addresses" class="md-nav__link">
    Searching For Email Addresses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maltego" title="Maltego" class="md-nav__link">
    Maltego
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port_scanning" title="Port Scanning" class="md-nav__link">
    Port Scanning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual_port_scanning" title="Manual Port Scanning" class="md-nav__link">
    Manual Port Scanning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated_port_scanning_-_nmap" title="Automated Port Scanning - NMap" class="md-nav__link">
    Automated Port Scanning - NMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_syn_scan" title="A SYN Scan" class="md-nav__link">
    A SYN Scan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a_version_scan" title="A Version Scan" class="md-nav__link">
    A Version Scan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#udp_scans" title="UDP Scans" class="md-nav__link">
    UDP Scans
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning_a_specific_port" title="Scanning A Specific Port" class="md-nav__link">
    Scanning A Specific Port
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav> 
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Information Gathering</h1>
                
                <p><strong>Goal of this phase is to learn about the targets as much as possible</strong></p>
<ul>
<li>Knowledge gained in this phase will be used to develop plans of attack</li>
<li>will be used for searching and verifying vulnerabilities</li>
</ul>
<h2 id="open_source_intelligence_gathering_osint">Open Source Intelligence Gathering (OSINT)</h2>
<ul>
<li>information is gathered from legal sources like public records / social media</li>
</ul>
<h3 id="netcraft">Netcraft</h3>
<ul>
<li>a compmay that logs the uptime and make queries about the underlying software</li>
</ul>
<p>e.g query for bulbsecurity.com</p>
<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030306.png.jpg" /></p>
<p>using this information basic attacks can be drafted / developed</p>
<ol>
<li>Rule out vulnerabilities that affect Microsoft IIS servers</li>
<li>Try out social engineering attack (phishing message from godaddy) to get credentials </li>
</ol>
<h3 id="whois_lookups">WhoIs Lookups</h3>
<ul>
<li>all domain registrars keep records of the domains they host</li>
<li>
<p>contain certain information about the owner, including contact information</p>
</li>
<li>
<p>to run WhoIs lookups, use the <code class="codehilite">whois</code> command</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@kali:~# whois bulbsecurity.com
</span>  Registered through: GoDaddy.com, LLC (http://www.godaddy.com)
   Domain Name: BULBSECURITY.COM
      Created on: 21-Dec-11
      Expires on: 21-Dec-12
      Last Updated on: 21-Dec-11

   Registrant: ❶
   Domains By Proxy, LLC
   DomainsByProxy.com
   14747 N Northsight Blvd Suite 111, PMB 309
   Scottsdale, Arizona 85260
   United States

   Technical Contact: ❷
      Private, Registration  BULBSECURITY.COM@domainsbyproxy.com
      Domains By Proxy, LLC
      DomainsByProxy.com
      14747 N Northsight Blvd Suite 111, PMB 309
      Scottsdale, Arizona 85260
      United States
      (480) 624-2599      Fax -- (480) 624-2598

   Domain servers in listed order:
<span class="hll">      NS65.DOMAINCONTROL.COM ❸
</span><span class="hll">      NS66.DOMAINCONTROL.COM
</span></pre></div>
</td></tr></table>

<p>No 3 tells that the two DNS servers used. This site uses private registration else, a lot of details would have been shown</p>
<h3 id="dns_reconnaissance">DNS Reconnaissance</h3>
<ul>
<li>Domain Name System (DNS) servers translate <strong>the human-readable url <a href="http://www.example.com">www.example.com</a> into an IP address</strong></li>
</ul>
<h4 id="nslookup">Nslookup</h4>
<ul>
<li>to get the ip address / vice-versa from an url, use the <code class="codehilite">nslookup</code> command</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>root@Kali:~# nslookup www.bulbsecurity.com
Server:    75.75.75.75
Address:   75.75.75.75#53

Non-authoritative answer:
www.bulbsecurity.com    canonical name = bulbsecurity.com.
Name:    bulbsecurity.com
<span class="hll">Address: 50.63.212.1 ❶
</span></pre></div>
</td></tr></table>

<p><code class="codehilite">nslookup</code> returned the IP address of the domain above.</p>
<ul>
<li>mail servers can be found by looking for MX records (DNS speak for email)</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>root@kali:~# nslookup
&gt; set type=mx
&gt; bulbsecurity.com
Server:    75.75.75.75
Address:   75.75.75.75#53

Non-authoritative answer:
bulbsecurity.com    mail exchanger = 40 ASPMX2.GOOGLEMAIL.com.
bulbsecurity.com    mail exchanger = 20 ALT1.ASPMX.L.GOOGLE.com.
bulbsecurity.com    mail exchanger = 50 ASPMX3.GOOGLEMAIL.com.
bulbsecurity.com    mail exchanger = 30 ALT2.ASPMX.L.GOOGLE.com.
bulbsecurity.com    mail exchanger = 10 ASPMX.L.GOOGLE.com.
</pre></div>
</td></tr></table>

<p>Nslookup says <em>bulbsecurity.com</em> is using Google Mail for its email servers</p>
<h4 id="host">Host</h4>
<p>Another utility for DNS queries is <strong>Host</strong></p>
<blockquote>
<p>syntax: <code class="codehilite">host -t ns &lt;domain&gt;</code></p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>root@kali:~# host -t ns zoneedit.com
zoneedit.com name server ns4.zoneedit.com.
zoneedit.com name server ns3.zoneedit.com.
--snip--
</pre></div>
</td></tr></table>

<p>The above output shows all the DNS servers for the website.</p>
<h4 id="zone_transfers">Zone Transfers</h4>
<ul>
<li>DNS zone transfers allow name servers to replicate all the entries about a domain.</li>
<li>many system administrators set up DNS zone transfers insecurely, so that anyone can transfer the DNS records for a domain</li>
<li>use the <code class="codehilite">l</code> option to specify the domain to transfer</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@kali:~# host -l zoneedit.com ns2.zoneedit.com
</span>Using domain server:
Name: ns2.zoneedit.com
Address: 69.72.158.226#53
Aliases:

zoneedit.com name server ns4.zoneedit.com.
zoneedit.com name server ns3.zoneedit.com.
zoneedit.com name server ns15.zoneedit.com.
zoneedit.com name server ns8.zoneedit.com.
zoneedit.com name server ns2.zoneedit.com.
zoneedit.com has address 64.85.73.107
www1.zoneedit.com has address 64.85.73.41
dynamic.zoneedit.com has address 64.85.73.112
bounce.zoneedit.com has address 64.85.73.100
--snip--
<span class="hll">mail2.zoneedit.com has address 67.15.232.182
</span>--snip-
</pre></div>
</td></tr></table>

<p>mail2.zoneedit.com is probably a mail server, so we should look for potentially vulnerable software running on typical email ports such as 25 (Simple Mail Transfer Protocol) and 110 (POP3). If we can find a webmail server, any usernames we find may lead us in the right direction so that we can guess passwords and gain access to sensitive company emails.</p>
<h3 id="searching_for_email_addresses">Searching For Email Addresses</h3>
<ul>
<li>One way to find usernames is by looking for email addresses on the Internet.</li>
<li>
<p>a python tool called <code class="codehilite">theHarvester</code> can quickly scour thousands of search engine results for possible email addresses</p>
</li>
<li>
<p>to look into the first 500 results in search engines for bulbsecurity.com use</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@kali:~# theharvester -d bulbsecurity.com -l 500 -b all
</span>
*******************************************************************
*                                                                 *
* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
* | __| &#39;_ \ / _ \  / /_/ / _` | &#39;__\ \ / / _ \/ __| __/ _ \ &#39;__| *
* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
*                                                                 *
* TheHarvester Ver. 2.2a                                          *
* Coded by Christian Martorella                                   *
* Edge-Security Research                                          *
* cmartorella@edge-security.com                                   *
*******************************************************************

Full harvest..
[-] Searching in Google..
    Searching 0 results...
    Searching 100 results...
    Searching 200 results...
    Searching 300 results...
--snip--

 [+] Emails found:
------------------
<span class="hll">georgia@bulbsecurity.com
</span>
[+] Hosts found in search engines:
------------------------------------
50.63.212.1:www.bulbsecurity.com

--snip--
</pre></div>
</td></tr></table>

<h3 id="maltego">Maltego</h3>
<ul>
<li>a data-mining tool designed to visualize open source intelligence gathering</li>
</ul>
<p>To run Maltego, run <code class="codehilite">maltego</code> at the command line. The Maltego GUI should launch.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>root@kali:~# maltego
</pre></div>
</td></tr></table>

<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030308.png.jpg" /></p>
<p>Now select the Palette option from the left-hand border. As you can see, we can gather information about all sorts of entities.</p>
<p>Let’s start with the bulbsecurity.com domain</p>
<p>Drag a Domain entity from the Palette onto the new graph. By default, the domain is paterva.com. To change it to bulbsecurity.com, either double-click the text or change the text field at the right side of the screen.</p>
<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030310.png.jpg" /></p>
<p>Once the domain is set, you can run transforms. Right-click the domain icon and choosing <strong>Run Transform</strong></p>
<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030312.png.jpg" /></p>
<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030314.png.jpg" /></p>
<p><img alt="" src="https://learning.oreilly.com/library/view/penetration-testing/9781457185342/httpatomoreillycomsourcenostarchimages2030316.png.jpg" /></p>
<p>Maltego finds that <a href="http://www.bulbsecurity.com">www.bulbsecurity.com</a> is an Apache web server with PHP, Flash, and so on, along with a WordPress install.</p>
<h3 id="port_scanning">Port Scanning</h3>
<ul>
<li>finding which systems / services are active and which software to talk to</li>
</ul>
<h4 id="manual_port_scanning">Manual Port Scanning</h4>
<p>Exploiting the MS08-067 vulnerability can be an easy win for attackers and pentesters alike. To use this exploit, we need to <strong>find a Windows 2000, XP, or 2003 box with an SMB server</strong> that is missing the MS08-067 Microsoft patch available on the network. We can get a good idea about the network-based attack surface by mapping the network range and querying systems for listening ports.</p>
<p>Port scanning can be done manually by connecting to ports with a tool such as <code class="codehilite">telnet</code> or <code class="codehilite">netcat</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>root@kali:~# nc -vv 192.168.20.10 25
<span class="hll">nc: 192.168.20.10 (192.168.20.10) 25 [smtp] open
</span>nc: using stream socket
nc: using buffer size 8192
nc: read 66 bytes from remote
<span class="hll">220 bookxp SMTP Server SLmail 5.5.0.4433 Ready
</span>ESMTP spoken here
nc: wrote 66 bytes to local
</pre></div>
</td></tr></table>

<p>The Windows XP box is running an SMTP server on port 25. After we connected, the SMTP server announced itself as SLMail -version 5.5.0.4433.</p>
<div class="admonition tip">
<p class="admonition-title">Tip<p>connecting to every possible TCP and UDP port on just one machine and noting the results can be time consuming. Port scanning tools such as <code class="codehilite">NMap</code> can be used to find listening ports</p>
</p>
</div>
<h4 id="automated_port_scanning_-_nmap">Automated Port Scanning - NMap</h4>
<ul>
<li>NMap is the industry standard for port scanning</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note<p>If NMap scan does not return any result, it is likely that intrusion detection systems / firewall have blocked the scan traffic</p>
</p>
</div>
<h5 id="a_syn_scan">A SYN Scan</h5>
<p>A SYN scan is a TCP scan that does not finish the TCP handshake. A TCP connection starts with a three-way handshake: SYN ▸ SYN-ACK ▸ ACK</p>
<div class="mermaid">
sequenceDiagram
    System1->>System2: SYN
    System2->>System1: SYN-ACK
    System1->>System2: ACK
</div>

<p>In a SYN scan, Nmap sends the SYN and waits for the SYN-ACK if the port is open but never sends the ACK to complete the connection. If the SYN packet receives no SYN-ACK response, the port is not available; either it’s closed or the connection is being filtered.</p>
<blockquote>
<p>syntax: for a SYN scan is <code class="codehilite">-sS</code> flag</p>
</blockquote>
<!--  -->

<blockquote>
<p>syntax: for outputing in all formats use <code class="codehilite">-oA</code> flag</p>
<blockquote>
<p>this will output the reports in nmap, gnmap (greppable nmap) and in xml formats
the reports can be imported in tools to read and analyze</p>
</blockquote>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@kali:~# nmap -sS 192.168.20.10-12 -oA booknmap
</span>
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 07:28 EST
Nmap scan report for 192.168.20.10
Host is up (0.00056s latency).
Not shown: 991 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp ❷
25/tcp   open  smtp ❺
80/tcp   open  http ❸
106/tcp  open  pop3pw ❺
110/tcp  open  pop3 ❺
135/tcp  open  msrpc
139/tcp  open  netbios-ssn ❹
443/tcp  open  https ❸
445/tcp  open  microsoft-ds ❹
1025/tcp open  NFS-or-IIS
3306/tcp open  mysql ❻
5000/tcp open  upnp
MAC Address: 00:0C:29:A5:C1:24 (VMware)

Nmap scan report for 192.168.20.11
Host is up (0.00031s latency).
Not shown: 993 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp ❷
22/tcp   open  ssh
80/tcp   open  http ❸
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn ❹
445/tcp  open  microsoft-ds ❹
2049/tcp open  nfs
MAC Address: 00:0C:29:FD:0E:40 (VMware)

Nmap scan report for 192.168.20.12
Host is up (0.0014s latency).
Not shown: 999 filtered ports
PORT     STATE SERVICE
80/tcp   open  http ❶
135/tcp  open  msrpc
MAC Address: 00:0C:29:62:D5:C8 (VMware)

Nmap done: 3 IP addresses (3 hosts up) scanned in 1070.40 seconds
</pre></div>
</td></tr></table>

<div class="admonition note on ports">
<p class="admonition-title">Note<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
</tr>
</thead>
<tbody>
<tr>
<td>69</td>
<td>TFTP - UDP port</td>
</tr>
<tr>
<td>80</td>
<td>HTTP Web Service</td>
</tr>
<tr>
<td>139</td>
<td>Remote Procedure Call</td>
</tr>
</tbody>
</table>
</p>
</div>
<h5 id="a_version_scan">A Version Scan</h5>
<ul>
<li>SYN scan does not tell which software is listening on the open ports</li>
</ul>
<blockquote>
<p>syntax: for nmap full TCP scan <code class="codehilite">nmap -sT</code></p>
</blockquote>
<!--  -->

<blockquote>
<p>systax: for nmap version scan <code class="codehilite">nmap -sV</code> </p>
<blockquote>
<p>yeilds more data</p>
</blockquote>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">root</span><span class="p">@</span><span class="k">kali</span><span class="o">:~</span><span class="err">#</span> <span class="nt">nmap</span> <span class="nt">-sV</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">10-12</span> <span class="nt">-oA</span> <span class="nt">bookversionnmap</span>
<span class="nt">Starting</span> <span class="nt">Nmap</span> <span class="nt">6</span><span class="p">.</span><span class="nc">40</span> <span class="o">(</span> <span class="nt">http</span><span class="o">://</span><span class="nt">nmap</span><span class="p">.</span><span class="nc">org</span> <span class="o">)</span> <span class="nt">at</span> <span class="nt">2015-12-18</span> <span class="nt">08</span><span class="p">:</span><span class="nd">29</span> <span class="nt">EST</span>
<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">10</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">00046s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">991</span> <span class="nt">closed</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span> <span class="nt">SERVICE</span>      <span class="nt">VERSION</span>
<span class="nt">21</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">ftp</span>          <span class="nt">FileZilla</span> <span class="nt">ftpd</span> <span class="nt">0</span><span class="p">.</span><span class="nc">9</span><span class="p">.</span><span class="nc">32</span> <span class="nt">beta</span>
<span class="nt">25</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">smtp</span>         <span class="nt">SLmail</span> <span class="nt">smtpd</span> <span class="nt">5</span><span class="p">.</span><span class="nc">5</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">4433</span>
<span class="nt">79</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">finger</span>       <span class="nt">SLMail</span> <span class="nt">fingerd</span>
<span class="nt">80</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">http</span>         <span class="nt">Apache</span> <span class="nt">httpd</span> <span class="nt">2</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">12</span> <span class="o">((</span><span class="nt">Win32</span><span class="o">)</span> <span class="nt">DAV</span><span class="o">/</span><span class="nt">2</span> <span class="nt">mod_ssl</span><span class="o">/</span><span class="nt">2</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">12</span> <span class="nt">OpenSSL</span><span class="o">/</span><span class="nt">0</span><span class="p">.</span><span class="nc">9</span><span class="p">.</span><span class="nc">8k</span>
                              <span class="nt">mod_autoindex_color</span> <span class="nt">PHP</span><span class="o">/</span><span class="nt">5</span><span class="p">.</span><span class="nc">3</span><span class="p">.</span><span class="nc">0</span> <span class="nt">mod_perl</span><span class="o">/</span><span class="nt">2</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">4</span> <span class="nt">Perl</span><span class="o">/</span><span class="nt">v5</span><span class="p">.</span><span class="nc">10</span><span class="p">.</span><span class="nc">0</span><span class="o">)</span>
<span class="nt">106</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">pop3pw</span>       <span class="nt">SLMail</span> <span class="nt">pop3pw</span>
<span class="nt">110</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">pop3</span>         <span class="nt">BVRP</span> <span class="nt">Software</span> <span class="nt">SLMAIL</span> <span class="nt">pop3d</span>
<span class="nt">135</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">msrpc</span>        <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">RPC</span>
<span class="nt">139</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">netbios-ssn</span>
<span class="nt">443</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">ssl</span><span class="o">/</span><span class="nt">http</span>     <span class="nt">Apache</span> <span class="nt">httpd</span> <span class="nt">2</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">12</span> <span class="o">((</span><span class="nt">Win32</span><span class="o">)</span> <span class="nt">DAV</span><span class="o">/</span><span class="nt">2</span> <span class="nt">mod_ssl</span><span class="o">/</span><span class="nt">2</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">12</span> <span class="nt">OpenSSL</span><span class="o">/</span><span class="nt">0</span><span class="p">.</span><span class="nc">9</span><span class="p">.</span><span class="nc">8k</span>
                              <span class="nt">mod_autoindex_color</span> <span class="nt">PHP</span><span class="o">/</span><span class="nt">5</span><span class="p">.</span><span class="nc">3</span><span class="p">.</span><span class="nc">0</span> <span class="nt">mod_perl</span><span class="o">/</span><span class="nt">2</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">4</span> <span class="nt">Perl</span><span class="o">/</span><span class="nt">v5</span><span class="p">.</span><span class="nc">10</span><span class="p">.</span><span class="nc">0</span><span class="o">)</span>
<span class="nt">445</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">microsoft-ds</span> <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">XP</span> <span class="nt">microsoft-ds</span>
<span class="nt">1025</span><span class="o">/</span><span class="nt">tcp</span> <span class="nt">open</span>  <span class="nt">msrpc</span>        <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">RPC</span>
<span class="nt">3306</span><span class="o">/</span><span class="nt">tcp</span> <span class="nt">open</span>  <span class="nt">mysql</span>        <span class="nt">MySQL</span> <span class="o">(</span><span class="nt">unauthorized</span><span class="o">)</span>
<span class="nt">5000</span><span class="o">/</span><span class="nt">tcp</span> <span class="nt">open</span>  <span class="nt">upnp</span>         <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">UPnP</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">A5</span><span class="p">:</span><span class="nd">C1</span><span class="p">:</span><span class="nd">24</span> <span class="o">(</span><span class="nt">Vmware</span><span class="o">)</span>
<span class="nt">Service</span> <span class="nt">Info</span><span class="o">:</span> <span class="nt">Host</span><span class="o">:</span> <span class="nt">georgia</span><span class="p">.</span><span class="nc">com</span><span class="p">;</span> <span class="nt">OS</span><span class="o">:</span> <span class="nt">Windows</span><span class="o">;</span> <span class="nt">CPE</span><span class="o">:</span> <span class="nt">cpe</span><span class="o">:/</span><span class="nt">o</span><span class="p">:</span><span class="nd">microsoft</span><span class="p">:</span><span class="nd">windows</span>

<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">11</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">00065s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">993</span> <span class="nt">closed</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span> <span class="nt">SERVICE</span>              <span class="nt">VERSION</span>
<span class="nt">21</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">ftp</span>                  <span class="nt">vsftpd</span> <span class="nt">2</span><span class="p">.</span><span class="nc">3</span><span class="p">.</span><span class="nc">4</span> <span class="nt">❶</span>
<span class="nt">22</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">ssh</span>                  <span class="nt">OpenSSH</span> <span class="nt">5</span><span class="p">.</span><span class="nc">1p1</span> <span class="nt">Debian</span> <span class="nt">3ubuntu1</span> <span class="o">(</span><span class="nt">protocol</span> <span class="nt">2</span><span class="p">.</span><span class="nc">0</span><span class="o">)</span>
<span class="nt">80</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">http</span>                 <span class="nt">Apache</span> <span class="nt">httpd</span> <span class="nt">2</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">9</span> <span class="o">((</span><span class="nt">Ubuntu</span><span class="o">)</span> <span class="nt">PHP</span><span class="o">/</span><span class="nt">5</span><span class="p">.</span><span class="nc">2</span><span class="p">.</span><span class="nc">6-2ubuntu4</span><span class="p">.</span><span class="nc">6</span> <span class="nt">with</span>
                                      <span class="nt">Suhosin-Patch</span><span class="o">)</span>
<span class="nt">111</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">rpcbind</span> <span class="o">(</span><span class="nt">rpcbind</span> <span class="nt">V2</span><span class="o">)</span> <span class="nt">2</span> <span class="o">(</span><span class="nt">rpc</span> <span class="p">#</span><span class="nn">100000</span><span class="o">)</span>
<span class="nt">139</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">netbios-ssn</span>          <span class="nt">Samba</span> <span class="nt">smbd</span> <span class="nt">3</span><span class="p">.</span><span class="nc">X</span> <span class="o">(</span><span class="nt">workgroup</span><span class="o">:</span> <span class="nt">WORKGROUP</span><span class="o">)</span>
<span class="nt">445</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">netbios-ssn</span>          <span class="nt">Samba</span> <span class="nt">smbd</span> <span class="nt">3</span><span class="p">.</span><span class="nc">X</span> <span class="o">(</span><span class="nt">workgroup</span><span class="o">:</span> <span class="nt">WORKGROUP</span><span class="o">)</span>
<span class="nt">2049</span><span class="o">/</span><span class="nt">tcp</span> <span class="nt">open</span>  <span class="nt">nfs</span> <span class="o">(</span><span class="nt">nfs</span> <span class="nt">V2-4</span><span class="o">)</span>       <span class="nt">2-4</span> <span class="o">(</span><span class="nt">rpc</span> <span class="p">#</span><span class="nn">100003</span><span class="o">)</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">FD</span><span class="p">:</span><span class="nd">0E</span><span class="p">:</span><span class="nd">40</span> <span class="o">(</span><span class="nt">VMware</span><span class="o">)</span>
<span class="nt">Service</span> <span class="nt">Info</span><span class="o">:</span> <span class="nt">OSs</span><span class="o">:</span> <span class="nt">Unix</span><span class="o">,</span> <span class="nt">Linux</span><span class="o">;</span> <span class="nt">CPE</span><span class="o">:</span> <span class="nt">cpe</span><span class="o">:/</span><span class="nt">o</span><span class="p">:</span><span class="nd">linux</span><span class="p">:</span><span class="nd">kernel</span>

<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">12</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">0010s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">999</span> <span class="nt">filtered</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span> <span class="nt">SERVICE</span>        <span class="nt">VERSION</span>
<span class="nt">80</span><span class="o">/</span><span class="nt">tcp</span>   <span class="nt">open</span>  <span class="nt">http</span>           <span class="nt">Microsoft</span> <span class="nt">IIS</span> <span class="nt">httpd</span> <span class="nt">7</span><span class="p">.</span><span class="nc">5</span>
<span class="nt">135</span><span class="o">/</span><span class="nt">tcp</span>  <span class="nt">open</span>  <span class="nt">msrpc</span>          <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">RPC</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">62</span><span class="p">:</span><span class="nd">D5</span><span class="p">:</span><span class="nd">C8</span> <span class="o">(</span><span class="nt">VMware</span><span class="o">)</span>

<span class="nt">Service</span> <span class="nt">detection</span> <span class="nt">performed</span><span class="o">.</span> <span class="nt">Please</span> <span class="nt">report</span> <span class="nt">any</span> <span class="nt">incorrect</span> <span class="nt">results</span> <span class="nt">at</span> <span class="nt">http</span><span class="o">://</span><span class="nt">nmap</span><span class="p">.</span><span class="nc">org</span><span class="o">/</span><span class="nt">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="nt">Nmap</span> <span class="nt">done</span><span class="o">:</span> <span class="nt">3</span> <span class="nt">IP</span> <span class="nt">addresses</span> <span class="o">(</span><span class="nt">3</span> <span class="nt">hosts</span> <span class="nt">up</span><span class="o">)</span> <span class="nt">scanned</span> <span class="nt">in</span> <span class="nt">20</span><span class="p">.</span><span class="nc">56</span> <span class="nt">seconds</span>
</pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note<p>Keep in mind that Nmap may report the wrong version in some cases (for instance, if the software has been updated, but the welcome banner is not edited as part of the patch), but at the very least, its version scan gave us a good place to begin further research.</p>
</p>
</div>
<h4 id="udp_scans">UDP Scans</h4>
<p>Both Nmap’s SYN and version scans are TCP scans that do not query UDP ports</p>
<p>Scanning logic of UDP is different. Nmap sends a packet. If the port is open, the packet is received else, an ICMP Port Unreachable message is sent.</p>
<div class="mermaid">
sequenceDiagram
    Nmap->>system1: sends a packet
    system1-->>Nmap: packet received - no error - port open
    system1->>Nmap: ICMP error - port closed
</div>

<blockquote>
<p>syntax: <code class="codehilite">nmap -sU</code> flag is used for UDP scan</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">root</span><span class="p">@</span><span class="k">kali</span><span class="o">:~</span><span class="err">#</span> <span class="nt">nmap</span> <span class="nt">-sU</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">10-12</span> <span class="nt">-oA</span> <span class="nt">bookudp</span>

<span class="nt">Starting</span> <span class="nt">Nmap</span> <span class="nt">6</span><span class="p">.</span><span class="nc">40</span> <span class="o">(</span> <span class="nt">http</span><span class="o">://</span><span class="nt">nmap</span><span class="p">.</span><span class="nc">org</span> <span class="o">)</span> <span class="nt">at</span> <span class="nt">2015-12-18</span> <span class="nt">08</span><span class="p">:</span><span class="nd">39</span> <span class="nt">EST</span>
<span class="nt">Stats</span><span class="o">:</span> <span class="nt">0</span><span class="p">:</span><span class="nd">11</span><span class="p">:</span><span class="nd">43</span> <span class="nt">elapsed</span><span class="p">;</span> <span class="nt">0</span> <span class="nt">hosts</span> <span class="nt">completed</span> <span class="o">(</span><span class="nt">3</span> <span class="nt">up</span><span class="o">),</span> <span class="nt">3</span> <span class="nt">undergoing</span> <span class="nt">UDP</span> <span class="nt">Scan</span>
<span class="nt">UDP</span> <span class="nt">Scan</span> <span class="nt">Timing</span><span class="o">:</span> <span class="nt">About</span> <span class="nt">89</span><span class="p">.</span><span class="nc">42</span><span class="o">%</span> <span class="nt">done</span><span class="o">;</span> <span class="nt">ETC</span><span class="o">:</span> <span class="nt">08</span><span class="p">:</span><span class="nd">52</span> <span class="o">(</span><span class="nt">0</span><span class="p">:</span><span class="nd">01</span><span class="p">:</span><span class="nd">23</span> <span class="nt">remaining</span><span class="o">)</span>
<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">10</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">00027s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">990</span> <span class="nt">closed</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span>         <span class="nt">SERVICE</span>
<span class="nt">69</span><span class="o">/</span><span class="nt">udp</span>   <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">tftp</span> <span class="nt">❶</span>
<span class="nt">123</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">ntp</span>
<span class="nt">135</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">msrpc</span>
<span class="nt">137</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">netbios-ns</span>
<span class="nt">138</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">netbios-dgm</span>
<span class="nt">445</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">microsoft-ds</span>
<span class="nt">500</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">isakmp</span>
<span class="nt">1026</span><span class="o">/</span><span class="nt">udp</span> <span class="nt">open</span>          <span class="nt">win-rpc</span>
<span class="nt">1065</span><span class="o">/</span><span class="nt">udp</span> <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">syscomlan</span>
<span class="nt">1900</span><span class="o">/</span><span class="nt">udp</span> <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">upnp</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">A5</span><span class="p">:</span><span class="nd">C1</span><span class="p">:</span><span class="nd">24</span> <span class="o">(</span><span class="nt">VMware</span><span class="o">)</span>

<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">11</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">00031s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">994</span> <span class="nt">closed</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span>         <span class="nt">SERVICE</span>
<span class="nt">68</span><span class="o">/</span><span class="nt">udp</span>   <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">dhcpc</span>
<span class="nt">111</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">rpcbind</span>
<span class="nt">137</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">netbios-ns</span>
<span class="nt">138</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">netbios-dgm</span>
<span class="nt">2049</span><span class="o">/</span><span class="nt">udp</span> <span class="nt">open</span>          <span class="nt">nfs</span> <span class="nt">❷</span>
<span class="nt">5353</span><span class="o">/</span><span class="nt">udp</span> <span class="nt">open</span>          <span class="nt">zeroconf</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">FD</span><span class="p">:</span><span class="nd">0E</span><span class="p">:</span><span class="nd">40</span> <span class="o">(</span><span class="nt">VMware</span><span class="o">)</span>

<span class="nt">Nmap</span> <span class="nt">scan</span> <span class="nt">report</span> <span class="nt">for</span> <span class="nt">192</span><span class="p">.</span><span class="nc">168</span><span class="p">.</span><span class="nc">20</span><span class="p">.</span><span class="nc">12</span>
<span class="nt">Host</span> <span class="nt">is</span> <span class="nt">up</span> <span class="o">(</span><span class="nt">0</span><span class="p">.</span><span class="nc">072s</span> <span class="nt">latency</span><span class="o">).</span>
<span class="nt">Not</span> <span class="nt">shown</span><span class="o">:</span> <span class="nt">999</span> <span class="nt">open</span><span class="o">|</span><span class="nt">filtered</span> <span class="nt">ports</span>
<span class="nt">PORT</span>     <span class="nt">STATE</span>         <span class="nt">SERVICE</span>
<span class="nt">137</span><span class="o">/</span><span class="nt">udp</span>  <span class="nt">open</span>          <span class="nt">netbios-ns</span>
<span class="nt">MAC</span> <span class="nt">Address</span><span class="o">:</span> <span class="nt">00</span><span class="p">:</span><span class="nd">0C</span><span class="p">:</span><span class="nd">29</span><span class="p">:</span><span class="nd">62</span><span class="p">:</span><span class="nd">D5</span><span class="p">:</span><span class="nd">C8</span> <span class="o">(</span><span class="nt">VMware</span><span class="o">)</span>

<span class="nt">Nmap</span> <span class="nt">done</span><span class="o">:</span> <span class="nt">3</span> <span class="nt">IP</span> <span class="nt">addresses</span> <span class="o">(</span><span class="nt">3</span> <span class="nt">hosts</span> <span class="nt">up</span><span class="o">)</span> <span class="nt">scanned</span> <span class="nt">in</span> <span class="nt">1073</span><span class="p">.</span><span class="nc">86</span> <span class="nt">seconds</span>
</pre></div>
</td></tr></table>

<h4 id="scanning_a_specific_port">Scanning A Specific Port</h4>
<p>By default, <strong>Nmap scans only the 1,000 ports</strong> it considers the most “interesting,” not the 65,535 possible TCP or UDP ports.</p>
<blockquote>
<p>syntax: use the <code class="codehilite">-p</code> flag to scan specific ports</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@Kali:~# nmap -sS -p 3232 192.168.20.10
</span>
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 09:03 EST
Nmap scan report for 192.168.20.10
Host is up (0.00031s latency).
PORT     STATE SERVICE
3232/tcp open  unknown
MAC Address: 00:0C:29:A5:C1:24 (VMware)
</pre></div>
</td></tr></table>

<ul>
<li>running a version scan against a specific port</li>
</ul>
<p><mark>this may sometime crash the service but some information can be obtained</mark></p>
<p>In the process of crashing the listening service, Nmap can’t figure out what software is running as noted at ❶, but it does manage to get a fingerprint of the service. Based on the HTML tags in the fingerprint at ❷, this service appears to be a web server. According to the Server: field, it is something called Zervit 0.4 ❸.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll">root@kali:~# nmap -p 3232 -sV 192.168.20.10
</span>Starting Nmap 6.40 ( http://nmap.org ) at 2015-04-28 10:19 EDT
Nmap scan report for 192.168.20.10
Host is up (0.00031s latency).
PORT     STATE SERVICE VERSION
3232/tcp open  unknown
1 service unrecognized despite returning data❶. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi : ❷
SF-Port3232-TCP:V=6.25%I=7%D=4/28%Time=517D2FFC%P=i686-pc-linux-gnu%r(GetR
<span class="hll">SF:equest,B8,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Zervit\x200\.4\r\n❸X-Pow
</span>SF:ered-By:\x20Carbono\r\nConnection:\x20close\r\nAccept-Ranges:\x20bytes\
SF:r\nContent-Type:\x20text/html\r\nContent-Length:\x2036\r\n\r\n<span class="nt">&lt;html&gt;</span>\r\
SF:n<span class="nt">&lt;body&gt;</span>\r\nhi\r\n<span class="nt">&lt;/body&gt;</span>\r\n<span class="nt">&lt;/html&gt;</span>&quot;);
MAC Address: 00:0C:29:13:FA:E3 (VMware)
</pre></div>
</td></tr></table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../links/" title="OSCP Links" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                OSCP Links
              </span>
            </div>
          </a>
        
        
          <a href="../../scanning/network_discovery/" title="Network discovery" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Network discovery
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; ha2332-2019
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.48c2c9de.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../assets/javascript/jquery-min.js"></script>
      
        <script src="../../../assets/javascript/mermaid.min.js"></script>
      
        <script src="../../../assets/javascript/raphael.min.js"></script>
      
        <script src="../../../assets/javascript/flowchart.min.js"></script>
      
        <script src="../../../assets/javascript/jquery-plugin.js"></script>
      
        <script src="../../../assets/javascript/extra.js"></script>
      
    
  </body>
</html>